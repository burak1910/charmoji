/* 1. KULLANICILAR TABLOSU */
CREATE TABLE Kullanicilar (
    KullaniciID INT AUTO_INCREMENT PRIMARY KEY,
    Ad VARCHAR(100) NOT NULL,
    Eposta VARCHAR(100) NOT NULL UNIQUE,
    SifreHash VARCHAR(255) NOT NULL,
    KayitTarihi DATETIME DEFAULT CURRENT_TIMESTAMP,
    -- Eksik olan avatar verisi
    AvatarURL VARCHAR(255) DEFAULT 'default.png',
    -- Level ve Para Sistemi
    Seviye INT DEFAULT 1,
    XP INT DEFAULT 0,
    Bakiye DECIMAL(10,2) DEFAULT 0.00
);

/* 2. KULLANICI STATLARI TABLOSU (Fotoğraftaki eksik tablo) */
CREATE TABLE KullaniciStatlari (
    StatID INT AUTO_INCREMENT PRIMARY KEY,
    KullaniciID INT NOT NULL,
    StatTuru VARCHAR(50) NOT NULL, -- Örn: 'Güç', 'Zeka'
    ToplamPuan INT DEFAULT 0,
    CONSTRAINT FK_Stat_Kullanici FOREIGN KEY (KullaniciID) 
        REFERENCES Kullanicilar(KullaniciID) ON DELETE CASCADE
);

/* 3. ALIŞKANLIKLAR TABLOSU */
CREATE TABLE Aliskanliklar (
    AliskanlikID INT AUTO_INCREMENT PRIMARY KEY,
    Ad VARCHAR(100) UNIQUE NOT NULL,
    Aciklama TEXT,
    VarsayilanHedef VARCHAR(50),
    HedefTipi VARCHAR(20),
    -- Eksik olan stat türü ve puan alanları
    StatTuru VARCHAR(50),
    Puan INT DEFAULT 10
);

/* 4. KULLANICI ALIŞKANLIKLARI */
CREATE TABLE KullaniciAliskanliklari (
    KullaniciAliskanlikID INT AUTO_INCREMENT PRIMARY KEY,
    KullaniciID INT NOT NULL,
    AliskanlikID INT NOT NULL,
    OzelHedefDegeri VARCHAR(50),
    BaslangicTarihi DATE NOT NULL,
    AktifMi TINYINT(1) DEFAULT 1,
    -- Eksik olan seri ve son işlem alanları
    Seri INT DEFAULT 0,
    SonIslemTarihi DATETIME NULL,
    CONSTRAINT FK_KA_Kullanici FOREIGN KEY (KullaniciID) REFERENCES Kullanicilar(KullaniciID),
    CONSTRAINT FK_KA_Aliskanlik FOREIGN KEY (AliskanlikID) REFERENCES Aliskanliklar(AliskanlikID)
);

/* 5. TAKİP KAYITLARI */
CREATE TABLE TakipKayitlari (
    KayitID INT AUTO_INCREMENT PRIMARY KEY,
    KullaniciAliskanlikID INT NOT NULL,
    Tarih DATE NOT NULL,
    GerceklesenDeger DECIMAL(10,2),
    TamamlandiMi TINYINT(1) NOT NULL DEFAULT 0, --
    CONSTRAINT FK_TK_KA FOREIGN KEY (KullaniciAliskanlikID) REFERENCES KullaniciAliskanliklari(KullaniciAliskanlikID)
);

/* 6. ARKADAŞLAR TABLOSU */
CREATE TABLE arkadaslar (
    ID INT AUTO_INCREMENT PRIMARY KEY,
    GonderenID INT NOT NULL,
    AliciID INT NOT NULL,
    Durum ENUM('Beklemede', 'Kabul', 'Red') DEFAULT 'Beklemede', --
    Tarih DATETIME DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT FK_Ark_Gonderen FOREIGN KEY (GonderenID) REFERENCES Kullanicilar(KullaniciID),
    CONSTRAINT FK_Ark_Alici FOREIGN KEY (AliciID) REFERENCES Kullanicilar(KullaniciID)
);

/* 7. MARKET EŞYALARI */
CREATE TABLE MarketEsyalari (
    EsyaID INT AUTO_INCREMENT PRIMARY KEY,
    Ad VARCHAR(100) NOT NULL,
    Aciklama VARCHAR(255),
    Fiyat DECIMAL(10,2) NOT NULL,
    GorselURL VARCHAR(255),
    EsyaTuru VARCHAR(50),
    GerekenSeviye INT DEFAULT 1 --
);

/* 8. KULLANICI ENVANTERİ */
CREATE TABLE KullaniciEnvanteri (
    EnvanterID INT AUTO_INCREMENT PRIMARY KEY,
    KullaniciID INT NOT NULL,
    EsyaID INT NOT NULL,
    AlimTarihi DATETIME DEFAULT CURRENT_TIMESTAMP,
    KusandiMi TINYINT(1) DEFAULT 0, --
    CONSTRAINT FK_Env_Kullanici FOREIGN KEY (KullaniciID) REFERENCES Kullanicilar(KullaniciID),
    CONSTRAINT FK_Env_Esya FOREIGN KEY (EsyaID) REFERENCES MarketEsyalari(EsyaID)
);

/* 9. GÖREV TANIMLARI */
CREATE TABLE GorevTanimlari (
    GorevTanimID INT AUTO_INCREMENT PRIMARY KEY,
    Baslik VARCHAR(100),
    Aciklama TEXT NOT NULL,
    OdulPara DECIMAL(10,2) DEFAULT 0.00,
    HedefSayi INT DEFAULT 1,
    Ikon VARCHAR(100) --
);

/* 10. KULLANICI GÜNLÜK GÖREVLERİ */
CREATE TABLE KullaniciGunlukGorevleri (
    KullaniciGorevID INT AUTO_INCREMENT PRIMARY KEY,
    KullaniciID INT NOT NULL,
    GorevTanimID INT NOT NULL,
    Tarih DATE DEFAULT (CURRENT_DATE),
    MevcutIlerleme INT DEFAULT 0,
    TamamlandiMi TINYINT(1) DEFAULT 0,
    OdulAlindiMi TINYINT(1) DEFAULT 0, --
    CONSTRAINT FK_KGG_Kullanici FOREIGN KEY (KullaniciID) REFERENCES Kullanicilar(KullaniciID),
    CONSTRAINT FK_KGG_Tanim FOREIGN KEY (GorevTanimID) REFERENCES GorevTanimlari(GorevTanimID)
);